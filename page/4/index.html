<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"reoger.tk","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="reoger">
<meta property="og:type" content="website">
<meta property="og:title" content="reoger的记录">
<meta property="og:url" content="http://reoger.tk/page/4/index.html">
<meta property="og:site_name" content="reoger的记录">
<meta property="og:description" content="reoger">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="reoger">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://reoger.tk/page/4/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>

  <title>reoger的记录</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">reoger的记录</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">--以后的你会感激现在那么努力的自己</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://reoger.tk/2018/07/10/android%E4%B8%ADSupport%20Annotation%20Lobrary%20%E6%B3%A8%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="reoger">
      <meta itemprop="description" content="reoger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="reoger的记录">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/10/android%E4%B8%ADSupport%20Annotation%20Lobrary%20%E6%B3%A8%E8%A7%A3/" class="post-title-link" itemprop="url">android中Support Annotation Lobrary 注解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-10 14:04:48" itemprop="dateCreated datePublished" datetime="2018-07-10T14:04:48+08:00">2018-07-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-12 22:54:54" itemprop="dateModified" datetime="2020-04-12T22:54:54+08:00">2020-04-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index"><span itemprop="name">android</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="android中Support-Annotation-Lobrary-注解"><a href="#android中Support-Annotation-Lobrary-注解" class="headerlink" title="android中Support Annotation Lobrary 注解"></a>android中Support Annotation Lobrary 注解</h1><p>官方文档写的太好了，我觉得不可能有他写的更好的文章了，所以就不打算了写了，官方连接<a href="https://developer.android.com/studio/write/annotations?hl=zh-cn" target="_blank" rel="noopener">https://developer.android.com/studio/write/annotations?hl=zh-cn</a>。</p>
<h1 id="速查表"><a href="#速查表" class="headerlink" title="速查表"></a>速查表</h1><table>
<thead>
<tr>
<th>注解</th>
<th>类型</th>
</tr>
</thead>
<tbody><tr>
<td><code>Nullable</code></td>
<td>标记的函数可以返回<code>null</code>,或者标记的参数可以为<code>null</code></td>
</tr>
<tr>
<td><code>NonNull</code></td>
<td>标记的函数可以不能为空,或者标记的参数不能为空</td>
</tr>
<tr>
<td><code>AnimatorRes</code></td>
<td>标记整型值是<code>android.R.animator</code>类型</td>
</tr>
<tr>
<td><code>AnimRes</code></td>
<td>标记整型值是<code>android.R.anim</code>类型</td>
</tr>
<tr>
<td><code>AnyRes</code></td>
<td>标记整型值是任意资源类型</td>
</tr>
<tr>
<td><code>ArrayRes</code></td>
<td>标记整型值是<code>android.R.array</code>类型</td>
</tr>
<tr>
<td><code>AttrRes</code></td>
<td>标记整型值是<code>android.R.attr</code>类型</td>
</tr>
<tr>
<td><code>BoolRes</code></td>
<td>标记整型值是布尔值类型</td>
</tr>
<tr>
<td><code>ColorRes</code></td>
<td>标记整型值是<code>android.R.color</code>类型</td>
</tr>
<tr>
<td><code>DrawableRes</code></td>
<td>标记整型值是<code>android.R.drawable</code>类型</td>
</tr>
<tr>
<td><code>FractionRes</code></td>
<td>标记整型值是<code>fraction</code>类型</td>
</tr>
<tr>
<td><code>IdRes</code></td>
<td>标记整型值是<code>android.R.id</code>类型</td>
</tr>
<tr>
<td><code>IntegerRes</code></td>
<td>标记整型值是<code>android.R.integer</code>类型</td>
</tr>
<tr>
<td><code>InterpolatorRes</code></td>
<td>标记整型值是<code>android.R.integer</code>类型</td>
</tr>
<tr>
<td><code>LayoutRes</code></td>
<td>标记整型值是<code>android.R.layout</code>类型</td>
</tr>
<tr>
<td><code>MenuRes</code></td>
<td>标记整型值是<code>android.R.menu</code>类型</td>
</tr>
<tr>
<td><code>PluralsRes</code></td>
<td>标记整型值是<code>android.R.plurals</code>类型</td>
</tr>
<tr>
<td><code>RawRes</code></td>
<td>标记整型值是<code>android.R.raw</code>类型</td>
</tr>
<tr>
<td><code>StringRes</code></td>
<td>标记整型值是<code>android.R.string</code>类型</td>
</tr>
<tr>
<td><code>StyleableRes</code></td>
<td>标记整型值是<code>android.R.styleable</code>类型</td>
</tr>
<tr>
<td><code>StyleRes</code></td>
<td>标记整型值是<code>android.R.style</code>类型</td>
</tr>
<tr>
<td><code>TransitionRes</code></td>
<td>标记整型值是<code>android.R.transition</code>类型</td>
</tr>
<tr>
<td><code>XmlRes</code></td>
<td>标记整型值是<code>android.R.xml</code>类型</td>
</tr>
<tr>
<td><code>ColorRes</code></td>
<td>标记参数类型需要传入的是颜色类型的资源ID</td>
</tr>
<tr>
<td><code>Size</code></td>
<td>标记参数的大小</td>
</tr>
<tr>
<td><code>Size(min = 1)</code></td>
<td>标记集合不可以为空</td>
</tr>
<tr>
<td><code>Size(max = 1024)</code></td>
<td>标记字符串最大的字符个数是1024</td>
</tr>
<tr>
<td><code>Size(2)</code></td>
<td>表示数组元素个数是2个</td>
</tr>
<tr>
<td><code>Size(multiple = 2)</code></td>
<td>标记数组的大小是2的倍数</td>
</tr>
<tr>
<td><code>IntRange(from =0,to = 255)</code></td>
<td>标记参数是从0-255之间的整型</td>
</tr>
<tr>
<td><code>FloatRange(from =0.0,to = 255.0)</code></td>
<td>标记参数是从0-255之间的浮点型</td>
</tr>
<tr>
<td><code>CallSuper</code></td>
<td>标记该方法在重写的同时一定要调用被这个方法</td>
</tr>
</tbody></table>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ul>
<li><a href="https://developer.android.com/studio/write/annotations?hl=zh-cn" target="_blank" rel="noopener">https://developer.android.com/studio/write/annotations?hl=zh-cn</a></li>
<li><a href="https://developer.android.com/guide/topics/resources/string-resource" target="_blank" rel="noopener">https://developer.android.com/guide/topics/resources/string-resource</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://reoger.tk/2018/07/09/%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BA-II-%E9%A2%98%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="reoger">
      <meta itemprop="description" content="reoger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="reoger的记录">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/09/%E4%B9%B0%E5%8D%96%E8%82%A1%E7%A5%A8%E7%9A%84%E6%9C%80%E4%BD%B3%E6%97%B6%E6%9C%BA-II-%E9%A2%98%E8%A7%A3/" class="post-title-link" itemprop="url">买卖股票的最佳时机 II 题解</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-09 23:55:48" itemprop="dateCreated datePublished" datetime="2018-07-09T23:55:48+08:00">2018-07-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-12 23:08:40" itemprop="dateModified" datetime="2020-04-12T23:08:40+08:00">2020-04-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="买卖股票的最佳时机-II"><a href="#买卖股票的最佳时机-II" class="headerlink" title="买卖股票的最佳时机 II"></a>买卖股票的最佳时机 II</h1><p>原题链接：<a href="https://leetcode-cn.com/explore/interview/card/top-interview-questions-easy/1/array/22/" target="_blank" rel="noopener">https://leetcode-cn.com/explore/interview/card/top-interview-questions-easy/1/array/22/</a>.</p>
<p>给定一个数组，它的第 i 个元素是一支给定股票第 i 天的价格。</p>
<p>设计一个算法来计算你所能获取的最大利润。你可以尽可能地完成更多的交易（多次买卖一支股票）。</p>
<p>注意：你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。</p>
<p><strong>示例 1:</strong></p>
<p>输入: [7,1,5,3,6,4]<br>输出: 7<br>解释: 在第 2 天（股票价格 = 1）的时候买入，在第 3 天（股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。<br>     随后，在第 4 天（股票价格 = 3）的时候买入，在第 5 天（股票价格 = 6）的时候卖出, 这笔交易所能获得利润 = 6-3 = 3 。</p>
<p><strong>示例 2:</strong></p>
<p>输入: [1,2,3,4,5]<br>输出: 4<br>解释: 在第 1 天（股票价格 = 1）的时候买入，在第 5 天 （股票价格 = 5）的时候卖出, 这笔交易所能获得利润 = 5-1 = 4 。<br>     注意你不能在第 1 天和第 2 天接连购买股票，之后再将它们卖出。<br>     因为这样属于同时参与了多笔交易，你必须在再次购买前出售掉之前的股票。</p>
<p><strong>示例 3:</strong></p>
<p>输入: [7,6,4,3,1]<br>输出: 0<br>解释: 在这种情况下, 没有交易完成, 所以最大利润为 0。</p>
<p>解题思路：<br>尽可能多的买股票，尽可能买一次股票多挣钱，这是本题的关键。本题最暴力的方法就是利用两层循环，第一层循环从i=0开始，表示应该从哪下手，第二层循环从i+1下手，表示该股票什么时候卖出去。股票卖出去的条件也很简单，首先是确保卖出去比买入的价钱高，并且第二天的价格不会比现在高就可以卖出去了。代码如下。</p>
<p>代码实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public int maxProfit(int[] prices) &#123;</span><br><span class="line">        int max &#x3D; 0;</span><br><span class="line">        for(int i&#x3D;0;i&lt;prices.length;i++)&#123;</span><br><span class="line">            for(int j&#x3D;i+1;j&lt;prices.length;j++)&#123;</span><br><span class="line">                if(prices[j] &gt; prices[i] )&#123;</span><br><span class="line">                    if (j+1&#x3D;&#x3D;prices.length || prices[j + 1] &lt; prices[j])&#123;</span><br><span class="line">                        max +&#x3D; prices[j]-prices[i];</span><br><span class="line">                        i &#x3D; j+1;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;else&#123;</span><br><span class="line">                    i&#x3D;j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return max;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://reoger.tk/2018/07/09/LayoutParams%E4%BD%BF%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="reoger">
      <meta itemprop="description" content="reoger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="reoger的记录">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/09/LayoutParams%E4%BD%BF%E7%94%A8/" class="post-title-link" itemprop="url">LayoutParams 使用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-09 10:55:48" itemprop="dateCreated datePublished" datetime="2018-07-09T10:55:48+08:00">2018-07-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-12 23:02:57" itemprop="dateModified" datetime="2020-04-12T23:02:57+08:00">2020-04-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index"><span itemprop="name">android</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ViewGroup-LayoutParams-的使用记录"><a href="#ViewGroup-LayoutParams-的使用记录" class="headerlink" title="ViewGroup.LayoutParams 的使用记录"></a>ViewGroup.LayoutParams 的使用记录</h1><p>LayoutParams类 一般用来child view（子视图） 向 parent view（父视图）传达自己的意图（孩子想变成什么样向其父亲说明），即子布局想在父布局中显示的属性（例如子布局多大、在那个位置）通过LayoutParams来进行展示。</p>
<h1 id="常见的属性"><a href="#常见的属性" class="headerlink" title="常见的属性"></a>常见的属性</h1><h2 id="宽-width-和高-hegit"><a href="#宽-width-和高-hegit" class="headerlink" title="宽(width)和高(hegit)"></a>宽(width)和高(hegit)</h2><p>宽和高一般来说有三种值：</p>
<ol>
<li>确定的数字</li>
<li>MATH_PARENT，和父布局一样大</li>
<li>WRAP_CONTENT，自己本身多大就显示多大</li>
</ol>
<h2 id="margin"><a href="#margin" class="headerlink" title="margin"></a>margin</h2><p>margin属性，上下左右边距。</p>
<h2 id=""><a href="#" class="headerlink" title=""></a></h2><p>更多的属性设置，可以参考<a href="https://developer.android.com/reference/android/R.styleable#ViewGroup_Layout" target="_blank" rel="noopener">https://developer.android.com/reference/android/R.styleable#ViewGroup_Layout</a>.</p>
<h2 id="具体使用"><a href="#具体使用" class="headerlink" title="具体使用"></a>具体使用</h2><p>例如向一个<code>RelativeLayout</code>的父布局中添加一个View，示例代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">RelativeLayout.LayoutParams layoutParams &#x3D; (RelativeLayout.LayoutParams) view.getLayoutParams();</span><br><span class="line">layoutParams.topMargin &#x3D; y;</span><br><span class="line">layoutParams.leftMargin &#x3D; x;</span><br><span class="line">view.setLayoutParams(layoutParams);</span><br></pre></td></tr></table></figure>
<p><strong>注意</strong>，父布局xml中是是<code>RelativeLayout</code>,子布局在<code>setLayoutParams</code>时，也必须是<code>RelativeLayout.LayoutParams</code>，否则会报错。</p>
<h2 id="具体实践"><a href="#具体实践" class="headerlink" title="具体实践"></a>具体实践</h2><p>添加用户引导，高亮某个按钮时的实现思路。一种总体思路，创建一个透明主题的activity，在activity中按钮的位置，添加一个相同的高亮按钮到这个透明主题的activity中，然后启动这个activity，将其覆盖展现在需要用户引导的界面，如此就实现了用户引导。<br>重点分析： 在父布局中添加子布局，并指定了位置。<br>关键代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;获取指定 view的位置，这个sTargetButton就是目标view</span><br><span class="line">  int[] location &#x3D; new int[2];</span><br><span class="line">    sTargetButton.getLocationOnScreen(location);</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;将view添加到父布局中,调整到制定位置。</span><br><span class="line"> ViewGroup.MarginLayoutParams margin &#x3D; new ViewGroup.MarginLayoutParams(view.getLayoutParams());</span><br><span class="line">        RelativeLayout.LayoutParams layoutParams &#x3D; (RelativeLayout.LayoutParams) view.getLayoutParams();</span><br><span class="line">        layoutParams.topMargin &#x3D; y;</span><br><span class="line">        layoutParams.leftMargin &#x3D; x;</span><br><span class="line">        view.setLayoutParams(layoutParams);</span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ul>
<li><a href="https://developer.android.com/reference/android/view/ViewGroup.LayoutParam" target="_blank" rel="noopener">https://developer.android.com/reference/android/view/ViewGroup.LayoutParam</a></li>
<li><a href="https://blog.csdn.net/superherowupan/article/details/51345975" target="_blank" rel="noopener">https://blog.csdn.net/superherowupan/article/details/51345975</a></li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://reoger.tk/2018/07/07/%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="reoger">
      <meta itemprop="description" content="reoger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="reoger的记录">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/07/07/%E4%B8%A4%E6%95%B0%E4%B9%8B%E5%92%8C/" class="post-title-link" itemprop="url">两个数组的交集 II(</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-07-07 10:55:48" itemprop="dateCreated datePublished" datetime="2018-07-07T10:55:48+08:00">2018-07-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-12 23:08:24" itemprop="dateModified" datetime="2020-04-12T23:08:24+08:00">2020-04-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/algorithm/" itemprop="url" rel="index"><span itemprop="name">algorithm</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h3 id="1-两数之和-Two-Sum"><a href="#1-两数之和-Two-Sum" class="headerlink" title="1. 两数之和(Two Sum)"></a><a href="https://leetcode-cn.com/problems/two-sum/description/" target="_blank" rel="noopener">1. 两数之和(Two Sum)</a></h3><p>题目难度： <strong>简单</strong></p>
<p>给定一个整数数组和一个目标值，找出数组中和为目标值的<strong>两个</strong>数。</p>
<p>你可以假设每个输入只对应一种答案，且同样的元素不能被重复利用。</p>
<p><strong>示例:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">给定 nums &#x3D; [2, 7, 11, 15], target &#x3D; 9</span><br><span class="line"></span><br><span class="line">因为 nums[**0**] + nums[**1**] &#x3D; 2 + 7 &#x3D; 9</span><br><span class="line">所以返回 [**0, 1**]</span><br></pre></td></tr></table></figure>



<h4 id="Solution"><a href="#Solution" class="headerlink" title="Solution"></a>Solution</h4><p>Language: <strong>Java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] twoSum(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">        <span class="keyword">if</span>(nums == <span class="keyword">null</span> || nums.length ==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">int</span> res[] = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.length;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;nums.length;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i!=j &amp;&amp; nums[i]+nums[j]== target)&#123;</span><br><span class="line">                    res[<span class="number">0</span>] = i;</span><br><span class="line">                    res[<span class="number">1</span>] = j;</span><br><span class="line">                    <span class="keyword">return</span> res;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="思路二：两遍哈希表"><a href="#思路二：两遍哈希表" class="headerlink" title="思路二：两遍哈希表"></a>思路二：两遍哈希表</h3><p>为了对运行时间复杂度进行优化，我们需要一种更有效的方法来检查数组中是否存在目标元素。如果存在，我们需要找出它的索引。保持数组中的每个元素与其索引相互对应的最好方法是什么？哈希表。</p>
<p>通过以空间换取速度的方式，我们可以将查找时间从 O(n)O(n) 降低到 O(1)O(1)。哈希表正是为此目的而构建的，它支持以 近似 恒定的时间进行快速查找。我用“近似”来描述，是因为一旦出现冲突，查找用时可能会退化到 O(n)O(n)。但只要你仔细地挑选哈希函数，在哈希表中进行查找的用时应当被摊销为 O(1)O(1)。</p>
<p>一个简单的实现使用了两次迭代。在第一次迭代中，我们将每个元素的值和它的索引添加到表中。然后，在第二次迭代中，我们将检查每个元素所对应的目标元素（target - nums[i]target−nums[i]）是否存在于表中。注意，该目标元素不能是 nums[i]nums[i] 本身！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">public int[] twoSum(int[] nums, int target) &#123;</span><br><span class="line">    Map&lt;Integer, Integer&gt; map &#x3D; new HashMap&lt;&gt;();</span><br><span class="line">    for (int i &#x3D; 0; i &lt; nums.length; i++) &#123;</span><br><span class="line">        map.put(nums[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    for (int i &#x3D; 0; i &lt; nums.length; i++) &#123;</span><br><span class="line">        int complement &#x3D; target - nums[i];</span><br><span class="line">        if (map.containsKey(complement) &amp;&amp; map.get(complement) !&#x3D; i) &#123;</span><br><span class="line">            return new int[] &#123; i, map.get(complement) &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    throw new IllegalArgumentException(&quot;No two sum solution&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>复杂度分析：</strong></p>
<ol>
<li><p>时间复杂度：O(n)O(n)， 我们把包含有 nn 个元素的列表遍历两次。由于哈希表将查找时间缩短到 O(1)O(1) ，所以时间复杂度为 O(n)O(n)。</p>
</li>
<li><p>空间复杂度：O(n)O(n)， 所需的额外空间取决于哈希表中存储的元素数量，该表中存储了 nn 个元素。 </p>
</li>
</ol>
<h3 id="改进为一遍哈希表"><a href="#改进为一遍哈希表" class="headerlink" title="改进为一遍哈希表"></a>改进为一遍哈希表</h3><p>事实证明，我们可以一次完成。在进行迭代并将元素插入到表中的同时，我们还会回过头来检查表中是否已经存在当前元素所对应的目标元素。如果它存在，那我们已经找到了对应解，并立即将其返回。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public int[] twoSum(int[] nums, int target) &#123;</span><br><span class="line">    Map&lt;Integer, Integer&gt; map &#x3D; new HashMap&lt;&gt;();</span><br><span class="line">    for (int i &#x3D; 0; i &lt; nums.length; i++) &#123;</span><br><span class="line">        int complement &#x3D; target - nums[i];</span><br><span class="line">        if (map.containsKey(complement)) &#123;</span><br><span class="line">            return new int[] &#123; map.get(complement), i &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        map.put(nums[i], i);</span><br><span class="line">    &#125;</span><br><span class="line">    throw new IllegalArgumentException(&quot;No two sum solution&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>复杂度分析：</strong><br>时间复杂度：O(n)， 我们只遍历了包含有 n个元素的列表一次。在表中进行的每次查找只花费 O(1)) 的时间。</p>
<p>空间复杂度：O(n)， 所需的额外空间取决于哈希表中存储的元素数量，该表最多需要存储 nn 个元素。</p>
<p>来源<a href="https://leetcode-cn.com/articles/two-sum/" target="_blank" rel="noopener">https://leetcode-cn.com/articles/two-sum/</a>。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://reoger.tk/2018/04/13/%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8Dview%E6%98%AF%E5%90%A6%E6%98%BE%E7%A4%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="reoger">
      <meta itemprop="description" content="reoger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="reoger的记录">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/13/%E5%88%A4%E6%96%AD%E5%BD%93%E5%89%8Dview%E6%98%AF%E5%90%A6%E6%98%BE%E7%A4%BA/" class="post-title-link" itemprop="url">判断当前view是否显示</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-04-13 22:34:53" itemprop="dateCreated datePublished" datetime="2018-04-13T22:34:53+08:00">2018-04-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-12 23:10:47" itemprop="dateModified" datetime="2020-04-12T23:10:47+08:00">2020-04-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">实习日记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近有一个这样的需求，需要知道某个view的展示率，但是这个view嵌套在一个滑动布局中，在当前view已经被添加到滑动布局的前提下，该view也不一定会展示，可能会出现的情况如下所示：</p>
<p><img src="https://upload-images.jianshu.io/upload_images/2178834-a3e2d70d30d522f1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="可能存在的情况.png"></p>
<p>那么，我们怎么判断当前的view是否展示了呢？</p>
<p>我的实现思路如下：</p>
<ol>
<li>首先，在添加view的时候，判断当前view是否展示，如果展示，直接上报即可。如果没有展示，而是如图所示的情况，那就存储一个sp的值，用于表示当前的view没有上报。</li>
<li>在滑动布局中，进行滑动监听。在滑动的过程中，判断当前的view是否上报，在没有上报的情况下，继续判断view是否显示，如果在混动过程中view显示了，就上报view显示了，并存储一个sp的值，用于表示当前的view已经上报了。</li>
</ol>
<p>上面的语言用代码表示为：<br>在添加view的逻辑中，用如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;addView代表该view被添加到当前布局了</span><br><span class="line">  if (addView()) &#123;</span><br><span class="line">&#x2F;&#x2F;parentView 即滑动布局</span><br><span class="line">            parentView.getViewTreeObserver().addOnGlobalLayoutListener(new ViewTreeObserver.OnGlobalLayoutListener() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void onGlobalLayout() &#123;</span><br><span class="line">                    parentView.getViewTreeObserver().removeOnGlobalLayoutListener(this);</span><br><span class="line">&#x2F;&#x2F;这里是判断当前布局是否可见</span><br><span class="line">                    if (CustomMainScrollView.checkIsVisible(mContext, parentView)) &#123;</span><br><span class="line">                        reportSkinShareCard(gamemaster_app_cardshow_new.OP_VISIBLE, false);</span><br><span class="line">                    &#125;else&#123;</span><br><span class="line">                        &#x2F;&#x2F;设置状态为未上报</span><br><span class="line">PreferencesUtils.getInstance().putBoolean(HAS_REPORT_SHOW_SKIN_THEME_CARD, false);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>然后在滑动布局中，监听滚动事件，调用下面的代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> private void reportSkinThemeCard(Context context, View skinThemeView) &#123;</span><br><span class="line">        boolean hasReport &#x3D; PreferencesUtils.getInstance().getBoolean(HAS_REPORT_SHOW_SKIN_THEME_CARD, false);</span><br><span class="line"></span><br><span class="line">        if (!hasReport &amp;&amp; checkIsVisible(context, skinThemeView) &amp;&amp; mSkinThemeView.getChildCount() !&#x3D; 0 ) &#123;</span><br><span class="line">            byte  cardStyle &#x3D; AbTestLogicManager.isSkinWithImageTestValue()?gamemaster_app_cardshow_new.CARD_TYPE_SKIN_WITH_IMAGE:gamemaster_app_cardshow_new.CRAD_SKIN_WITH_TEXT;</span><br><span class="line"></span><br><span class="line">            &#x2F;&#x2F; todo 在这里进行上报操作</span><br><span class="line">            PreferencesUtils.getInstance().putBoolean(PreferenceConstants.HAS_REPORT_SHOW_SKIN_THEME_CARD, true);</span><br><span class="line">&#x2F;&#x2F;最后，更新状态，避免重复上报</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>在补充一个检查当前view是否显示的方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public static Boolean checkIsVisible(Context context, View view) &#123;</span><br><span class="line">        int screenWidth &#x3D; getScreenMetrics(context).x;</span><br><span class="line">        int screenHeight &#x3D; getScreenMetrics(context).y;</span><br><span class="line">        Rect rect &#x3D; new Rect(0, 0, screenWidth, screenHeight);</span><br><span class="line">        int[] location &#x3D; new int[2];</span><br><span class="line">        view.getLocationInWindow(location);</span><br><span class="line">        if (view.getLocalVisibleRect(rect)) &#123;</span><br><span class="line">            return true;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://reoger.tk/2018/03/17/android%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%8A%A0%E8%BD%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="reoger">
      <meta itemprop="description" content="reoger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="reoger的记录">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/03/17/android%E4%B8%AD%E7%9A%84%E7%B1%BB%E5%8A%A0%E8%BD%BD/" class="post-title-link" itemprop="url">android中的类加载</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-03-17 21:21:33" itemprop="dateCreated datePublished" datetime="2018-03-17T21:21:33+08:00">2018-03-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-12 22:55:21" itemprop="dateModified" datetime="2020-04-12T22:55:21+08:00">2020-04-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">实习日记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>主要介绍几个知识点：</p>
<h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><a href="https://www.jianshu.com/p/3afa47e9112e" target="_blank" rel="noopener">https://www.jianshu.com/p/3afa47e9112e</a></li>
<li>&lt;…&gt;</li>
</ul>
<h1 id="java中常用的classLoader"><a href="#java中常用的classLoader" class="headerlink" title="java中常用的classLoader"></a>java中常用的<code>classLoader</code></h1><p>说到android中的<code>classLoader</code>，就不能不先说说java中的<code>classLoader</code>是什么。<br>所谓classLoader就是负责将编译好的class文件加载到指定位置的实现类。具体来说，我们编写java代码时，需要将其编译成.class文件，最终运行时就需要将这些class文件加载到内存才能运行，而加载这些class文件的方法就可以成为classLoader。<br>在java中常用的classLoader有以下三种：</p>
<h2 id="Bootstrap-Classloder"><a href="#Bootstrap-Classloder" class="headerlink" title="Bootstrap Classloder"></a>Bootstrap Classloder</h2><p> 这个类加载使用C++语言实现，是虚拟机自身的一部分。他是三个类加载器中最顶层的加载类，主要负责加载%JAVA_HOME%/lib下的核心类或者jar加载到内存中。（值得注意的是，Bootstrao Loader被设计成只能加载包名为java、javax、sun等开头的类.）</p>
<h2 id="Extention-Classloder"><a href="#Extention-Classloder" class="headerlink" title="Extention Classloder"></a>Extention Classloder</h2><p>扩展类的加载器，由java语言实现，主要负载加载<code>%JAVA_HOME%/lib/ext</code>目录下的类库，或者是系统指定的类库。</p>
<h2 id="AppClassloader"><a href="#AppClassloader" class="headerlink" title="AppClassloader"></a>AppClassloader</h2><p> 主要负责加载系统类路径或者指定路径下的类库。<br>以上三种是java中定义的ClassLoader。</p>
<h1 id="下面介绍android中常用的类加载器。"><a href="#下面介绍android中常用的类加载器。" class="headerlink" title="下面介绍android中常用的类加载器。"></a>下面介绍android中常用的类加载器。</h1><h2 id="classLoader"><a href="#classLoader" class="headerlink" title="classLoader"></a>classLoader</h2><p>所有的classLoader的基类，他是一个抽象类，所有的<code>classLoader</code>最终都会继承自他，我们如果需要自定义classLoader也需要直接或者间接的继承他，并实现其中的<code>findClass</code>方法，并通过<code>defineClass</code>创建一个类实例。自定义类加载的示例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">class NetworkClassLoader extends ClassLoader &#123;</span><br><span class="line">        String host;</span><br><span class="line">         int port;</span><br><span class="line"></span><br><span class="line">         public Class findClass(String name) &#123;</span><br><span class="line">             byte[] b &#x3D; loadClassData(name);</span><br><span class="line">             return defineClass(name, b, 0, b.length);</span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">         private byte[] loadClassData(String name) &#123;</span><br><span class="line">             &#x2F;&#x2F; load the class data from the connection</span><br><span class="line">             &#x2F;&#x2F;省略</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;</span><br></pre></td></tr></table></figure>

<h2 id="BaseDexClassLoader"><a href="#BaseDexClassLoader" class="headerlink" title="BaseDexClassLoader"></a>BaseDexClassLoader</h2><p>BaseDexClassLoader继承自ClassLoader，只是对其进行了进一步的封装，并没有实现，他有两个直接的子类<code>PathClassLoader</code>和<code>DexClassLoader</code>。<br>简单介绍一下他的构造函数：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public BaseDexClassLoader(String dexPath, File optimizedDirectory, String librarySearchPath, ClassLoader parent) &#123;</span><br><span class="line">  &#x2F;&#x2F;dexPath 代表目标类所在的apk、DEX或者JAR文件的路径</span><br><span class="line">  &#x2F;&#x2F;optimizedDirectory用于指定解压出来的dex文件存放的路径</span><br><span class="line">  &#x2F;&#x2F;librarySearchPath用于指定类中所使用的C&#x2F;C++库存放的路径</span><br><span class="line">  &#x2F;&#x2F;parent 用于指定该加载器的父加载器，一般为当前执行类的加载器</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>关于BaseDexClassLoader还有一点要补充的是，由于dex文件被包含在APK或者jar文件中，因此在加载目标类之前需要先从APK或者jar文件中加压处dex文件，optimizedDirectory即为指定解压出来的dex文件存放的路径，这也是对apk中dex根据平台ODEX优化的过程。</p>
<h2 id="DexClassLoader"><a href="#DexClassLoader" class="headerlink" title="DexClassLoader"></a>DexClassLoader</h2><p>DexClassLoader用于加载包含dex的JAR或者APK文件，但是他不能加载jar或者apk文件。他最终加载的都是dex文件，虽然他是从.jar或者.zip，.apk等结尾的文件中加载，但是他们最终都会生成一个对应的dex文件，他操作的还是dex文件。DexClassLoader继承自BaseDexClassLoader，原理如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class DexClassLoader extends BaseDexClassLoader &#123;</span><br><span class="line">    public DexClassLoader(String dexPath, String optimizedDirectory,</span><br><span class="line">            String libraryPath, ClassLoader parent) &#123;</span><br><span class="line">        super(dexPath, new File(optimizedDirectory), libraryPath, parent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>由代码不能看出，DexClassLoader只是简单的对BaseDexClassLoader进行了一层封装，并且指定了<code>optimizedDirectory</code>的路径为一个新的文件路径，DexClassLoader通过指定自己的optimizedDirectory，所以它可以加载外部的dex，因为这个dex会被复制到内部路径的optimizedDirectory。<br><strong>所以，DexClassLoader一般用来作为动态加载的加载器。</strong></p>
<h2 id="PathClassLoader"><a href="#PathClassLoader" class="headerlink" title="PathClassLoader"></a>PathClassLoader</h2><p>PathClassLoader也是继承自BaseDexClassLoader，他主要用于加载apk，一般应用于加载android的系统类和app应用的类。他的实现如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class PathClassLoader extends BaseDexClassLoader &#123;</span><br><span class="line">    public PathClassLoader(String dexPath, ClassLoader parent) &#123;</span><br><span class="line">        super(dexPath, null, null, parent);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public PathClassLoader(String dexPath, String libraryPath,</span><br><span class="line">            ClassLoader parent) &#123;</span><br><span class="line">        super(dexPath, null, libraryPath, parent);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到，PathClassLoader将optimizedDirectory置为null，而optimizedDirectory是用来指定apk或者jar解压出来的dex存放的位置，如果optimizedDirectory为null，则使用其默认路径/data/dalvik-cache，因此无法加载外部的apk的dex，只能加载内部的dex，这些大都是存在系统中已经安装过的apk里面的。</p>
<h2 id="URLClassLoader"><a href="#URLClassLoader" class="headerlink" title="URLClassLoader"></a>URLClassLoader</h2><p>URLClassLoader只能加载jar文件，但是dalvik虚拟机不能识别jar，所以在android中无法使用这个加载器。</p>
<h2 id="InMemoryDexClassLoader"><a href="#InMemoryDexClassLoader" class="headerlink" title="InMemoryDexClassLoader"></a>InMemoryDexClassLoader</h2><p>InMemoryDexClassLoader也是继承自BeseDexClassLoader，是API26新增的加载器，用于加载内存中的dex文件。</p>
<h2 id="DelegateLastClassLoader"><a href="#DelegateLastClassLoader" class="headerlink" title="DelegateLastClassLoader"></a>DelegateLastClassLoader</h2><p>DelegateLastClassLoader继承自PathClassLoader，是API27新增的加载器，用于指定最后的查找策略，查找顺序如下：先判断自己是否加载此类，然后在判断此类的加载器是否加载过此类，最后委托给指定的父加载器。</p>
<h1 id="classloader的双亲委托模型"><a href="#classloader的双亲委托模型" class="headerlink" title="classloader的双亲委托模型"></a><code>classloader</code>的双亲委托模型</h1><p>classLoader双亲委托模型，当要加载某个类时，先判断自己是否有加载过此类，如果自己没有加在过此类的话，进而判断父类是否加载过，如果某个父类加在过这个类的话，就直接返回，不重复加载。如果一直到顶级父类都没有加载此类的话，这个加载任务就会分发下来，最后用当前类加载器去加载该类。</p>
<h1 id="类加载机制实现热修复方案"><a href="#类加载机制实现热修复方案" class="headerlink" title="类加载机制实现热修复方案"></a>类加载机制实现热修复方案</h1><p>通过使用dexClassloader动态修改加载dex的顺序即可达到热修复的目的。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://reoger.tk/2018/01/18/AOP-%E7%BC%96%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="reoger">
      <meta itemprop="description" content="reoger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="reoger的记录">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/18/AOP-%E7%BC%96%E7%A8%8B/" class="post-title-link" itemprop="url">AOP 编程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-01-18 20:22:12" itemprop="dateCreated datePublished" datetime="2018-01-18T20:22:12+08:00">2018-01-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-12 22:56:07" itemprop="dateModified" datetime="2020-04-12T22:56:07+08:00">2020-04-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">实习日记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul>
<li><a href="https://www.jianshu.com/p/9fb07b2596f7" target="_blank" rel="noopener">Android AOP面向切面编程详解</a></li>
<li><a href="http://blog.csdn.net/innost/article/details/49387395" target="_blank" rel="noopener">深入理解Android之AOP</a></li>
<li><a href="http://blog.csdn.net/autfish/article/details/51184405" target="_blank" rel="noopener">http://blog.csdn.net/autfish/article/details/51184405</a></li>
</ul>
<hr>
<h1 id="AOP-基本思想"><a href="#AOP-基本思想" class="headerlink" title="AOP 基本思想"></a>AOP 基本思想</h1><p>刚接触编程的时候，一般先接触的c语言这类的OOP（Procedure Oriented，即面向过程）语言，面相过程是一种以过程为中心的编程思想。这些都是以什么正在发生为主要目标进行编程，就是分析出解决问题所需要的步骤，然后用函数把这些步骤一步一步实现，使用的时候一个一个依次调用就可以了。</p>
<p>然后，我们就会学到另一种更符合我们思维方式的一种思想，OOP（Object-Oriented Programming，即面向过程程序设计）语言，面向过程其实是最为实际的一种思考方式，就算是面向对象的方法也是含有面向过程的思想。可以说面向过程是一种基础的方法。它考虑的是实际地实现。一般的面向过程是从上往下步步求精，所以面向过程最重要的是模块化的思想方法。对比面向过程，面向对象的方法主要是把事物给对象化，对象包括属性与行为。当程序规模不是很大时，面向过程的方法还会体现出一种优势。因为程序的流程很清楚，按着模块与函数的方法可以很好的组织。<br>但是，在重复代码很多，需要重复利用的情况下，面相对象程序设计也显得很鸡肋，必要每次都主动去调用该方法，而且有特殊需求的时候还不能去需改写好的方法，因为这可能会造成其他其他调用该方法的地方出现问题。</p>
<p>这个时候AOP就出现了。AOP是Aspect Oriented Programming的缩写，即『面向切面编程』。它和我们平时接触到的OOP都是编程的不同思想，OOP，即『面向对象编程』，它提倡的是将功能模块化，对象化，而AOP的思想，则不太一样，它提倡的是针对同一类问题的统一处理，通过预编译方式和运行期动态代理实现程序功能的统一维护的一种技术。AOP是OOP的延续，是软件开发中的一个热点，也是Spring框架中的一个重要内容，是函数式编程的一种衍生范型。利用AOP可以对业务逻辑的各个部分进行隔离，从而使得业务逻辑各部分之间的耦合度降低，提高程序的可重用性，同时提高了开发的效率。</p>
<p>最后总结成一句话就是：<br><strong>在运行时，动态地将代码切入到类的指定方法、指定位置上的编程思想就是面向切面的编程。</strong></p>
<h1 id="编程实践"><a href="#编程实践" class="headerlink" title="编程实践"></a>编程实践</h1><p>讲了思想，我们通过具体的例子来进行说明。我们实现为方法自动添加log日志，不同于以前的主动调用，我们通过Aspect来实现AOP注入。</p>
<p>项目代码托管：<a href="https://github.com/Reoger/AOPTest" target="_blank" rel="noopener">https://github.com/Reoger/AOPTest</a></p>
<p>首先是配置：<code>app</code>下的<code>build.gradle</code>文件，配置类似如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">apply plugin: &#39;com.android.application&#39;</span><br><span class="line">import org.aspectj.bridge.IMessage</span><br><span class="line">import org.aspectj.bridge.MessageHandler</span><br><span class="line">import org.aspectj.tools.ajc.Main</span><br><span class="line"></span><br><span class="line">buildscript &#123;</span><br><span class="line">    repositories &#123;</span><br><span class="line">        mavenCentral()</span><br><span class="line">    &#125;</span><br><span class="line">    dependencies &#123;</span><br><span class="line">        classpath &#39;org.aspectj:aspectjtools:1.8.9&#39;</span><br><span class="line">        classpath &#39;org.aspectj:aspectjweaver:1.8.9&#39;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">repositories &#123;</span><br><span class="line">    mavenCentral()</span><br><span class="line">&#125;</span><br><span class="line">final def log &#x3D; project.logger</span><br><span class="line">final def variants &#x3D; project.android.applicationVariants</span><br><span class="line">variants.all &#123; variant -&gt;</span><br><span class="line">    if (!variant.buildType.isDebuggable()) &#123;</span><br><span class="line">        log.debug(&quot;Skipping non-debuggable build type &#39;$&#123;variant.buildType.name&#125;&#39;.&quot;)</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    JavaCompile javaCompile &#x3D; variant.javaCompile</span><br><span class="line">    javaCompile.doLast &#123;</span><br><span class="line">        String[] args &#x3D; [&quot;-showWeaveInfo&quot;,</span><br><span class="line">                         &quot;-1.8&quot;,</span><br><span class="line">                         &quot;-inpath&quot;, javaCompile.destinationDir.toString(),</span><br><span class="line">                         &quot;-aspectpath&quot;, javaCompile.classpath.asPath,</span><br><span class="line">                         &quot;-d&quot;, javaCompile.destinationDir.toString(),</span><br><span class="line">                         &quot;-classpath&quot;, javaCompile.classpath.asPath,</span><br><span class="line">                         &quot;-bootclasspath&quot;, project.android.bootClasspath.join(File.pathSeparator)]</span><br><span class="line">        log.debug &quot;ajc args: &quot; + Arrays.toString(args)</span><br><span class="line"></span><br><span class="line">        MessageHandler handler &#x3D; new MessageHandler(true);</span><br><span class="line">        new Main().run(args, handler);</span><br><span class="line">        for (IMessage message : handler.getMessages(null, true)) &#123;</span><br><span class="line">            switch (message.getKind()) &#123;</span><br><span class="line">                case IMessage.ABORT:</span><br><span class="line">                case IMessage.ERROR:</span><br><span class="line">                case IMessage.FAIL:</span><br><span class="line">                    log.error message.message, message.thrown</span><br><span class="line">                    break;</span><br><span class="line">                case IMessage.WARNING:</span><br><span class="line">                    log.warn message.message, message.thrown</span><br><span class="line">                    break;</span><br><span class="line">                case IMessage.INFO:</span><br><span class="line">                    log.info message.message, message.thrown</span><br><span class="line">                    break;</span><br><span class="line">                case IMessage.DEBUG:</span><br><span class="line">                    log.debug message.message, message.thrown</span><br><span class="line">                    break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">    compileSdkVersion 25</span><br><span class="line">    buildToolsVersion &#39;25.0.0&#39;</span><br><span class="line">    defaultConfig &#123;</span><br><span class="line">        applicationId &quot;com.example.cm.aoptest&quot;</span><br><span class="line">        minSdkVersion 20</span><br><span class="line">        targetSdkVersion 25</span><br><span class="line">        versionCode 1</span><br><span class="line">        versionName &quot;1.0&quot;</span><br><span class="line">        testInstrumentationRunner &quot;android.support.test.runner.AndroidJUnitRunner&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    buildTypes &#123;</span><br><span class="line">        release &#123;</span><br><span class="line">            minifyEnabled false</span><br><span class="line">            proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    compile fileTree(include: [&#39;*.jar&#39;], dir: &#39;libs&#39;)</span><br><span class="line">    androidTestCompile(&#39;com.android.support.test.espresso:espresso-core:2.2.2&#39;, &#123;</span><br><span class="line">        exclude group: &#39;com.android.support&#39;, module: &#39;support-annotations&#39;</span><br><span class="line">    &#125;)</span><br><span class="line">    compile &#39;com.android.support:appcompat-v7:25.3.1&#39;</span><br><span class="line">    compile &#39;com.android.support.constraint:constraint-layout:1.0.2&#39;</span><br><span class="line">    compile &#39;org.aspectj:aspectjrt:1.8.9&#39;</span><br><span class="line">    testCompile &#39;junit:junit:4.12&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>然后就是实现我们的要实现的注入的log方法，<code>AspectLogTest.java</code>代码如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">import android.util.Log;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import org.aspectj.lang.JoinPoint;</span><br><span class="line">import org.aspectj.lang.annotation.Aspect;</span><br><span class="line">import org.aspectj.lang.annotation.Before;</span><br><span class="line">import org.aspectj.lang.annotation.Pointcut;</span><br><span class="line">import org.aspectj.lang.reflect.MethodSignature;</span><br><span class="line"></span><br><span class="line">import java.lang.annotation.ElementType;</span><br><span class="line">import java.lang.annotation.Retention;</span><br><span class="line">import java.lang.annotation.RetentionPolicy;</span><br><span class="line">import java.lang.annotation.Target;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#x2F;**</span><br><span class="line"> * Created by CM on 2018&#x2F;1&#x2F;18.</span><br><span class="line"> *</span><br><span class="line"> *&#x2F;</span><br><span class="line">@Aspect</span><br><span class="line">public class AspectLogTest &#123;</span><br><span class="line"></span><br><span class="line">    @Target(ElementType.METHOD) &#x2F;&#x2F;可以注解在方法 上</span><br><span class="line">    @Retention(RetentionPolicy.RUNTIME) &#x2F;&#x2F;运行时（执行时）存在</span><br><span class="line">    public @interface AspectLog &#123;</span><br><span class="line">        String value();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    final static String TAG &#x3D; &quot;TAG&quot;;</span><br><span class="line"></span><br><span class="line">    @Pointcut(&quot;execution(@com.example.cm.aoptest.log.AspectLogTest.AspectLog * *(..))&quot;)</span><br><span class="line">    public void logForActivity()&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Before(&quot;logForActivity()&quot;)</span><br><span class="line">    public Object doRealLog(JoinPoint joinPoint)&#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            MethodSignature methodSignature &#x3D; (MethodSignature) joinPoint.getSignature();</span><br><span class="line">            AspectLog aspectJAnnotation &#x3D; methodSignature.getMethod().getAnnotation(AspectLog.class);</span><br><span class="line">            String log &#x3D; aspectJAnnotation.value();</span><br><span class="line">            Log.d(TAG, &quot;doRealLog: 打印日志&quot;+log);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>写好了接口，我们来实现自动注入代码，这里我们还是需要借助注解来实现。如果我们向打印<code>onCreate()</code>、<code>onStart()</code>等方法的中的信息，我们在<code>MainActivity</code>中这么写。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@AspectLogTest.AspectLog(value &#x3D; &quot;来自OnStop的日志信息&quot;)</span><br><span class="line">@Override</span><br><span class="line">protected void onStop() &#123;</span><br><span class="line">    super.onStop();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@AspectLogTest.AspectLog(value &#x3D; &quot;来自OnPause的日志信息&quot;)</span><br><span class="line">@Override</span><br><span class="line">protected void onPause() &#123;</span><br><span class="line">    super.onPause();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@AspectLogTest.AspectLog(value &#x3D; &quot;来自OnCreate的日志信息&quot;)</span><br><span class="line">@Override</span><br><span class="line">protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">    super.onCreate(savedInstanceState);</span><br><span class="line">    setContentView(R.layout.activity_main);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后就实现这里自动log功能。<br>当然，从这个例子看起来好像和自己手动写<code>Log.d()</code>没有区别，只是用注解的方式调用而已。但是这里仅仅是为了展示他的功能，真正使用的时候我们可以通过他们来实现复杂的控制。</p>
<p>介绍一下Aspect常见的注解。</p>
<ul>
<li><strong>@Aspect</strong> 把当前类标识为一个切面供容器读取</li>
<li><strong>@Before</strong> 表示一个前置增强方法</li>
<li><strong>@AfterReturning</strong> 表示一个后置增强方法</li>
<li><strong>@AfterThrowing</strong> 异常抛出增强</li>
<li><strong>@After</strong> final增强，不管是抛出异常或是正常退出都会执行</li>
<li><strong>@Around</strong> 环绕增强，先执行注入的方法，只有返回对应现场才能执行被注入的方法。</li>
<li><strong>@DeclareParents</strong> 引介增强</li>
</ul>
<p>介绍一下<code>execution</code>切点函数，其定义为<code>execution([方法修饰符] [返回类型] 方法名 参数 [异常模式])</code><br>在上例中，我们的<code>execution</code>函数为：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execution(@com.example.cm.aoptest.log.AspectLogTest.AspectLog * *(..))</span><br></pre></td></tr></table></figure>
<p>注意这里的方法名需要添加包名，*表示匹配任意字符，..表示匹配任意字符，可以匹配任意多个元素。<br>+必须跟在类名后面，表示类本身和继承或扩展制定类的所有类。</p>
<h1 id="基础概念"><a href="#基础概念" class="headerlink" title="基础概念"></a>基础概念</h1><ul>
<li><strong>PointCut 切入点</strong>：想要动态添加代码的连接点</li>
<li><strong>Advice 通知</strong> ：向切点中注入代码实现方法</li>
<li><strong>Aspect 切面</strong> ：切入点和通知的集合。</li>
<li><strong>Joint Point 连接点</strong>：所有目标方法都是连接点</li>
<li><strong>Weaving 编织</strong> 将切面代码注入到目标中，并生成代码混合到.class的过程。</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://reoger.tk/2018/01/17/android-%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7%E7%AF%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="reoger">
      <meta itemprop="description" content="reoger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="reoger的记录">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/17/android-%E5%BC%80%E5%8F%91%E6%8A%80%E5%B7%A7%E7%AF%87/" class="post-title-link" itemprop="url">android-开发技巧表</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-01-17 19:50:52" itemprop="dateCreated datePublished" datetime="2018-01-17T19:50:52+08:00">2018-01-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-12 22:54:34" itemprop="dateModified" datetime="2020-04-12T22:54:34+08:00">2020-04-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">实习日记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ul>
<li><a href="http://blog.csdn.net/my_truelove/article/details/52240558" target="_blank" rel="noopener">超详细的dubug教程</a></li>
<li><a href="http://www.10tiao.com/html/169/201612/2650821802/1.html" target="_blank" rel="noopener">Android Studio 调试技巧</a></li>
<li><a href="https://www.jianshu.com/p/a3459ffe4a95?utm_campaign=maleskine&utm_content=note&utm_medium=seo_notes&utm_source=recommendation" target="_blank" rel="noopener">Android中开发需要的高效助推的命令总结</a></li>
<li><a href="http://blog.csdn.net/soslinken/article/details/50245865" target="_blank" rel="noopener">Android adb shell am 命令介绍</a></li>
<li><a href="https://www.jianshu.com/p/d859480613a4" target="_blank" rel="noopener">adb shell dumpsys 命令用法</a></li>
<li><a href="http://gityuan.com/2017/07/04/ams_dumpsys/" target="_blank" rel="noopener">AMS之dumpsys篇</a></li>
</ul>
<h1 id="debug-技巧"><a href="#debug-技巧" class="headerlink" title="debug 技巧"></a>debug 技巧</h1><p>关于android studio的debug技巧，前面的两篇参考文章已经写的特别好了，也没必要再写一次了，主要就记录一下debug的关键概念和快捷键。至于如何debug，就请参考前面两篇文章。</p>
<h2 id="工具栏介绍"><a href="#工具栏介绍" class="headerlink" title="工具栏介绍"></a>工具栏介绍</h2><p><img src="http://ovec6nnof.bkt.clouddn.com/too.png" alt=""></p>
<p>上图从左往右看，名称和作用如下表所示。</p>
<table>
<thead>
<tr>
<th>名称</th>
<th>作用</th>
<th>备注</th>
<th>快捷键</th>
</tr>
</thead>
<tbody><tr>
<td>show Execution Point</td>
<td>定位到当前正在调试的位置</td>
<td>无备注</td>
<td>alt+F10</td>
</tr>
<tr>
<td>step over</td>
<td>单步跳过</td>
<td>一步一步执行，遇到方法会直接执行方法，然后进入下一步，不会进入方法内容</td>
<td>F8</td>
</tr>
<tr>
<td>step into</td>
<td>单步跳入</td>
<td>单步向下执行，如果当前是自定义方法，hi进入方法内部，系统方法则不进入方法内部</td>
<td>F7</td>
</tr>
<tr>
<td>Force step into</td>
<td>强制单步跳入</td>
<td>与单步跳入不同的是，不管什么方法他都会进入</td>
<td>Alt + Shfit + F7</td>
</tr>
<tr>
<td>step out</td>
<td>单步跳出</td>
<td>与单步跳入相对，表示从方法体中跳出，回到进入方法的位置，以继续断点</td>
<td>shfit + F8</td>
</tr>
<tr>
<td>run to cursor</td>
<td>执行到光标处</td>
<td>直接从当前位置运行到光标处，但是能被中间的断点拦截。</td>
<td>alt + F9</td>
</tr>
<tr>
<td>Evalyate Exoression</td>
<td>计算表达式</td>
<td>支持在点点过程中，通过直接赋值或者表达式方式，修改任意表俩个的值。</td>
<td>alt+F8</td>
</tr>
</tbody></table>
<p>再加来几个快捷键。</p>
<table>
<thead>
<tr>
<th>快捷键</th>
<th>功能</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>右击断点</td>
<td>为断点设置执行条件，或打印信息</td>
<td>只能针对本断点生效</td>
</tr>
<tr>
<td>alt + 单击</td>
<td>查看断点时变量的值</td>
<td>无</td>
</tr>
<tr>
<td>ctrl+alt+F8</td>
<td>为断点添加执行条件，或打印信息</td>
<td>这个可以对所有的断点生效</td>
</tr>
</tbody></table>
<h1 id="工具篇"><a href="#工具篇" class="headerlink" title="工具篇"></a>工具篇</h1><h2 id="uiautorviewer"><a href="#uiautorviewer" class="headerlink" title="uiautorviewer"></a>uiautorviewer</h2><p>可以通过这个工具快速定位到UI控件的ID，并通过ID快速找到相应的逻辑。</p>
<h2 id="DDMS"><a href="#DDMS" class="headerlink" title="DDMS"></a>DDMS</h2><p>可以利用ddms这个工具，实现截屏，查看线程和堆信息，日志信息，进程，广播状态信息，模拟来电，呼叫和短信等功能。<br>具体使用方法参考这里<a href="https://developer.android.com/studio/profile/monitor.html" target="_blank" rel="noopener">https://developer.android.com/studio/profile/monitor.html</a></p>
<h1 id="命令篇"><a href="#命令篇" class="headerlink" title="命令篇"></a>命令篇</h1><h2 id="adb-shell-am"><a href="#adb-shell-am" class="headerlink" title="adb shell am"></a>adb shell am</h2><p>am 就是activity manager的简称，可以用于启动activity、打开或关闭进程、发送广播等操作。<br>关于具体的命令，可以参考这里<a href="http://blog.csdn.net/soslinken/article/details/50245865" target="_blank" rel="noopener">http://blog.csdn.net/soslinken/article/details/50245865</a>.<br>然后，这里就记录常用的<code>adb shell am</code>命令。<br>[注：这里默认省略了<code>adb shell</code>]</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
<th>备注</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>am start -n &lt;package name&gt;/&lt;ativity name&gt;</code></td>
<td>启动acivity</td>
<td>-n 表示以组件式启动，还可以</td>
<td><code>am start -a android.settings.INPUT_METHOD_SETTINGS</code>//使用Action方式打开系统设置-输入法设置</td>
</tr>
<tr>
<td><code>am start -a -n --es extra &quot;hello&quot; --ei pid 10  &lt;package name&gt;/&lt;ativity name&gt;</code></td>
<td>待参数的启动activity</td>
<td>–es 表示带string，–ei 表示整型数据,都是以键值对的形式</td>
<td><code>am start -a -n --es extra &quot;hello&quot; --ei pid 10 com.reoger.app/com.example.cm.myapplication.NextActivity</code></td>
</tr>
<tr>
<td><code>am  broadcast -a &lt;action&gt;</code></td>
<td>启动广播</td>
<td>还可以通过<code>--user</code>指定用户发送广播</td>
<td><code>com.android.broadcast.test</code></td>
</tr>
<tr>
<td><code>am  broadcast  -a  &lt;action&gt; --es &lt;key&gt;  &lt;value&gt;</code></td>
<td>带信息的发送广播</td>
<td>–es表示字符串，还有–ez（布尔值）等多种类型数据，都是以键值对的形式</td>
<td><code>am  broadcast  -a  com.android.broadcast.test --es adb_extra &quot;hello&quot;</code></td>
</tr>
<tr>
<td><code>am startservice &lt;package name&gt;/&lt;service name&gt;</code></td>
<td>启动服务</td>
<td>可以通过<code>--user&lt;USER_ID&gt;</code>指定启动的用户</td>
<td><code>am startservice com.reoger.app/com.example.cm.myapplication.MyService</code></td>
</tr>
<tr>
<td><code>am force-stop &lt;package name&gt;</code></td>
<td>关闭指定包名的应用程序</td>
<td>无</td>
<td><code>am force-stop com.reoger.app</code></td>
</tr>
<tr>
<td><code>am kill &lt;package name&gt;</code></td>
<td>杀死与应该程序包想关联的所有进程，但只会杀死安全进程</td>
<td>可以通过<code>--user &lt;USER_ID&gt;</code>指定用户</td>
<td><code>am kill com.reoger.app</code></td>
</tr>
<tr>
<td><code>am kill -all</code></td>
<td>杀死全部的后台进程</td>
<td>无</td>
<td><code>am kill -all</code></td>
</tr>
</tbody></table>
<p>详情参考这里：<a href="http://blog.csdn.net/soslinken/article/details/50245865" target="_blank" rel="noopener">http://blog.csdn.net/soslinken/article/details/50245865</a></p>
<h2 id="adb-shell-pm"><a href="#adb-shell-pm" class="headerlink" title="adb shell pm"></a>adb shell pm</h2><p>pm即是 package manager的简称，可以用于安装应用、查询应用信息、系统权限、控制应用。</p>
<table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
<th>备注</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td><code>pm list packages [options] [fileter]</code></td>
<td>打印所有已经安装的应用的包名</td>
<td>options 常用的有<code>-3</code> 表示只显示第三方应用的包名，filter表示按名字筛选</td>
<td><code>pm list packages -e</code> 显示可用的应用和包名</td>
</tr>
<tr>
<td><code>pm list permission [options] [group]</code></td>
<td>打印权限</td>
<td><code>-g</code>表示按组列出，<code>-s</code>表示简短打印</td>
<td><code>pm list permission-groups</code>  打印所有已知的权限组</td>
</tr>
<tr>
<td><code>grant &lt;package_name&gt; &lt;permission&gt;</code></td>
<td>授予应用权限</td>
<td>必须android 6.0及以上的设备</td>
<td><code>grant com.reoger.app android.permission.WRITE_EXTERNAL_STORAGE</code></td>
</tr>
<tr>
<td><code>revoke &lt;package_name&gt; &lt;permission&gt;</code></td>
<td>撤销应用权限</td>
<td>必须android 6.0及以上的设备</td>
<td><code>revoke com.reoger.app android.permission.WRITE_EXTERNAL_STORAGE</code></td>
</tr>
<tr>
<td><code>pm clear &lt;package name&gt;</code></td>
<td>清除应用数据</td>
<td>无</td>
<td><code>pm clear com.reoger.app</code></td>
</tr>
<tr>
<td><code>pm enable &lt;package or component&gt;</code></td>
<td>使得packaege或componet可用</td>
<td>只针对第系统应用</td>
<td><code>pm enable com.reoger.app</code></td>
</tr>
<tr>
<td><code>pm hide &lt;package or component&gt;</code></td>
<td>隐藏package或componet</td>
<td>被隐藏应用在管理中变得不可见，桌面图标也会消失</td>
<td><code>pm hide com.reoger.app</code></td>
</tr>
<tr>
<td><code>pm unhide &lt;package or component&gt;</code></td>
<td>取消隐藏package或componet</td>
<td>桌面图标需要重新添加</td>
<td><code>pm unhide com.reoger.app</code></td>
</tr>
</tbody></table>
<p>详情请参考这里：<a href="https://www.cnblogs.com/JianXu/p/5380882.html" target="_blank" rel="noopener">https://www.cnblogs.com/JianXu/p/5380882.html</a></p>
<h2 id="adb-shell-dumysys"><a href="#adb-shell-dumysys" class="headerlink" title="adb shell dumysys"></a>adb shell dumysys</h2><table>
<thead>
<tr>
<th>命令</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td><code>dumpsys cpuinfo</code></td>
<td>查看CPU信息</td>
</tr>
<tr>
<td><code>dumpsys activity</code></td>
<td>查看一大堆信息，包括activity、broadcasts、providers、permissions等等信息</td>
</tr>
<tr>
<td><code>dumpsys activity top</code></td>
<td>获取当前android系统中与用户交互的activity的详细信息</td>
</tr>
<tr>
<td><code>dumpsys activity activities</code></td>
<td>显示当前所有运行的任务栈,可以与管道<code>- grep XXX</code>结合使用，用于筛选我们需要的任务栈</td>
</tr>
<tr>
<td><code>dumpsys activity meminfo &lt;package name&gt;</code></td>
<td>显示应用内存使用的情况</td>
</tr>
<tr>
<td><code>dumpsys activity package &lt;package name&gt;</code></td>
<td>显示apk的信息</td>
</tr>
</tbody></table>
<p>其中的<code>dumpsys activity [options] [WHAT]</code>参数可选如下：</p>
<table>
<thead>
<tr>
<th>option</th>
<th>含义</th>
</tr>
</thead>
<tbody><tr>
<td>-a</td>
<td>包括所有可用server状态</td>
</tr>
<tr>
<td>-c</td>
<td>包括client状态，即app端情况</td>
</tr>
<tr>
<td>-p package</td>
<td>限定输出指定包名</td>
</tr>
</tbody></table>
<p>其中WHAT参数可选如下：</p>
<table>
<thead>
<tr>
<th>WHAT</th>
<th>解释</th>
<th>对应源码</th>
</tr>
</thead>
<tbody><tr>
<td>a[ctivities]</td>
<td>activity状态</td>
<td>dumpActivitiesLocked()</td>
</tr>
<tr>
<td>b[roadcasts] [PACKAGE_NAME]</td>
<td>broadcast状态</td>
<td>dumpBroadcastsLocked()</td>
</tr>
<tr>
<td>s[ervices] [COMP_SPEC …]</td>
<td>service状态</td>
<td>newServiceDumperLocked().dumpLocked</td>
</tr>
<tr>
<td>prov[iders] [COMP_SPEC …]</td>
<td>content provider状态</td>
<td>dumpProvidersLocked()</td>
</tr>
<tr>
<td>p[rocesses] [PACKAGE_NAME]</td>
<td>进程状态</td>
<td>dumpProcessesLocked()</td>
</tr>
<tr>
<td>o[om]</td>
<td>内存管理</td>
<td>dumpOomLocked()</td>
</tr>
<tr>
<td>i[ntents] [PACKAGE_NAME]</td>
<td>pending intent状态</td>
<td>dumpPendingIntentsLocked()</td>
</tr>
<tr>
<td>r[ecents]</td>
<td>最近activity</td>
<td>dumpRecentsLocked()</td>
</tr>
<tr>
<td>perm[issions]</td>
<td>URI授权情况</td>
<td>dumpPermissionsLocked()</td>
</tr>
<tr>
<td>all</td>
<td>所有activities信息</td>
<td>dumpActivity()</td>
</tr>
<tr>
<td>top</td>
<td>顶部activity信息</td>
<td>dumpActivity()</td>
</tr>
<tr>
<td>package</td>
<td>package相关信息</td>
<td>dump()</td>
</tr>
</tbody></table>
<p>最后，附上我用于测试adb 命令的demo：<a href="https://github.com/Reoger/adbTest" target="_blank" rel="noopener">https://github.com/Reoger/adbTest</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://reoger.tk/2018/01/15/git-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="reoger">
      <meta itemprop="description" content="reoger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="reoger的记录">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/15/git-%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/" class="post-title-link" itemprop="url">git 学习记录</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-01-15 19:50:52" itemprop="dateCreated datePublished" datetime="2018-01-15T19:50:52+08:00">2018-01-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-12 22:52:56" itemprop="dateModified" datetime="2020-04-12T22:52:56+08:00">2020-04-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">实习日记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>git作为老牌的版本控制工具，功能和作用就不用说了。今天就记录一下，今天的学习成功吧。</p>
<p><img src="http://ovec6nnof.bkt.clouddn.com/git.png" alt="常见git命令"></p>
<h1 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a>参考链接</h1><ul>
<li><p><a href="http://www.imooc.com/article/14193" target="_blank" rel="noopener">git常见命令</a></p>
</li>
<li><p><a href="https://www.liaoxuefeng.com/wiki/0013739516305929606dd18361248578c67b8067c8c017b000" target="_blank" rel="noopener">Git教程-廖雪峰</a></p>
</li>
<li><p><a href="https://www.cnblogs.com/wanqieddy/archive/2012/08/21/2649428.html" target="_blank" rel="noopener">git stash 和 git cherry-pick</a></p>
</li>
<li><p><a href="http://blog.csdn.net/chenansic/article/details/44122107" target="_blank" rel="noopener">git rebase 使用详解</a></p>
</li>
<li><p><a href="http://finalshares.cn/attachment/1509/thread/95_80_cbcb426e1ba4faf.jpg" target="_blank" rel="noopener">git命令大全</a></p>
</li>
<li><p><a href="http://www.yiibai.com/git/" target="_blank" rel="noopener">Git教程</a></p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://reoger.tk/2018/01/12/gradle%E5%9F%BA%E7%A1%80/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="reoger">
      <meta itemprop="description" content="reoger">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="reoger的记录">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/01/12/gradle%E5%9F%BA%E7%A1%80/" class="post-title-link" itemprop="url">gradle基础</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2018-01-12 14:50:13" itemprop="dateCreated datePublished" datetime="2018-01-12T14:50:13+08:00">2018-01-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-04-12 22:57:37" itemprop="dateModified" datetime="2020-04-12T22:57:37+08:00">2020-04-12</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%AE%9E%E4%B9%A0%E6%97%A5%E8%AE%B0/" itemprop="url" rel="index"><span itemprop="name">实习日记</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p><em>Gradle 是一个能通过插件形式自定义构建逻辑的优秀构建工具。</em></p>
<p>以下的一些特性让我们选择了 Gradle：</p>
<ul>
<li>使用领域专用语言（DSL）来描述和控制构建逻辑</li>
<li>构建文件基于 Groovy，并允许通过 DSL 来声明元素、使用代码操作 DSL 元素这样的混<br>合方式来自定义构建逻辑</li>
<li>内置了 Maven 和 Ivy 来进行依赖管理</li>
<li>相当灵活。允许使用最好的实现，但是不会强制实现的形式</li>
<li>插件可以提供它们的 DSL 和 API 来定义构建文件</li>
<li>优秀的 API 工具与 IDE 集成</li>
</ul>
<p>这里主要记录几个比较常用，重要的点。</p>
<h1 id="android-Task"><a href="#android-Task" class="headerlink" title="android Task"></a>android Task</h1><ul>
<li><code>assemble</code> 组合项目所有输出，他可以细分成<code>assemableDebug</code>和<code>assembleRelease</code>。</li>
<li><code>check</code> 执行所有检查，他拥有 <code>lint</code> 依赖</li>
<li><code>connectedCheck</code> 在一个连接的设备或者模拟器上执行检查，他们可以在所有连接的设备上并行执行检查,他拥有<code>connectedAndroidTest</code>依赖</li>
<li><code>deviceCheck</code> 通过APIs连接远程设备来执行检查，主要用于CI（持续集成）服务上。</li>
<li><code>build</code> 执行<code>assemle</code>和<code>check</code>的所有工作</li>
<li><code>clean</code> 清空项目的输出。</li>
<li><code>installDebug</code> 安装测试版的apk</li>
<li><code>installRelease</code> 安装发布版的apk</li>
<li><code>uninstall</code> 卸载安装，他包含三个动作<code>uninstallDebug</code>卸载测试版本， <code>uninstallRelease</code>卸载发行版本和<code>uninstallDebugAndroidTest</code>卸载android测试。</li>
</ul>
<h1 id="gradle-添加依赖"><a href="#gradle-添加依赖" class="headerlink" title="gradle 添加依赖"></a>gradle 添加依赖</h1><p>gradle的依赖主要分成本地包依赖和远程包依赖。<br>依赖的关键字主要包括：</p>
<ol>
<li><code>compile</code> 源代码(src/main/java)编译时的依赖</li>
<li><code>runtime</code> 源代码(src/main/java)执行时的依赖</li>
<li><code>testCompile</code> 测试代码(src/main/test)编译时的依赖</li>
<li><code>testRuntime</code> 测试代码(src/main/test)执行时的依赖</li>
<li><code>archives</code> 项目打包时的依赖</li>
<li><code>provided</code> 只编译，并不将jar包导入到apk中。</li>
</ol>
<p>依赖格式:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compile group: &#39;org.hibernate&#39;, name: &#39;hibernate-core&#39;, version: &#39;3.6.7.Final&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中的group表示组织，name表示要依赖的库，vesion表示版本。<br>我们可以简写成</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">    compile &#39;org.hibernate:hibernate-core:3.6.7.Final&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当然，不单只有对jar包的依赖，还可以有对文件的依赖，对项目的依赖，他们的写法依次如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br><span class="line">dependencies &#123;</span><br><span class="line">    compile fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;]) &#x2F;&#x2F;将本地lib目录下所有的jar包进行依赖</span><br><span class="line">    compile files(&#39;libs&#x2F;picasso-2.4.0.jar&#39;)</span><br><span class="line">    compile project(&#39;:libraries:lib1&#39;)  &#x2F;&#x2F;对项目lib1添加依赖</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>##本地依赖<br>上面讲到的就是本地依赖的方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">dependencies &#123;</span><br><span class="line">compile fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;])</span><br><span class="line">&#125;</span><br><span class="line">android &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="外部依赖"><a href="#外部依赖" class="headerlink" title="外部依赖"></a>外部依赖</h2><p>首先需要添加远程仓库，android中至少添加一个远程仓库，例如使用开放的maven仓库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">repositories&#123;</span><br><span class="line">    mavenCentral()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后，就对添加具体依赖。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">dependencies&#123;</span><br><span class="line">    compile group: &#39;commons-collections&#39;,name: &#39;commons-collections&#39;, version: &#39;3.2&#39;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="混淆"><a href="#混淆" class="headerlink" title="混淆"></a>混淆</h1><p>启动混淆非常简单，只需要在<code>build.gradle</code>中启动即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">buildTypes &#123;</span><br><span class="line">    release &#123;</span><br><span class="line">        minifyEnabled true</span><br><span class="line">        proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中的<code>minfyEnabled</code>默认是false，即不混淆，因为启动混淆编译速度会比较慢。<br>与混淆相关的还有一个<code>shrinkResources</code>属性，可以通过将其设置为<code>true</code>，设置资不打包没用的资源。</p>
<p>混淆通用规则：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">#指定压缩级别</span><br><span class="line">-optimizationpasses 5</span><br><span class="line"></span><br><span class="line">#不跳过非公共的库的类成员</span><br><span class="line">-dontskipnonpubliclibraryclassmembers</span><br><span class="line"></span><br><span class="line">#混淆时采用的算法</span><br><span class="line">-optimizations !code&#x2F;simplification&#x2F;arithmetic,!field&#x2F;*,!class&#x2F;merging&#x2F;*</span><br><span class="line"></span><br><span class="line">#把混淆类中的方法名也混淆了</span><br><span class="line">-useuniqueclassmembernames</span><br><span class="line"></span><br><span class="line">#优化时允许访问并修改有修饰符的类和类的成员 </span><br><span class="line">-allowaccessmodification</span><br><span class="line"></span><br><span class="line">#将文件来源重命名为“SourceFile”字符串</span><br><span class="line">-renamesourcefileattribute SourceFile</span><br><span class="line">#保留行号</span><br><span class="line">-keepattributes SourceFile,LineNumberTable</span><br><span class="line"></span><br><span class="line">#保持所有实现 Serializable 接口的类成员</span><br><span class="line">-keepclassmembers class * implements java.io.Serializable &#123;</span><br><span class="line">    static final long serialVersionUID;</span><br><span class="line">    private static final java.io.ObjectStreamField[] serialPersistentFields;</span><br><span class="line">    private void writeObject(java.io.ObjectOutputStream);</span><br><span class="line">    private void readObject(java.io.ObjectInputStream);</span><br><span class="line">    java.lang.Object writeReplace();</span><br><span class="line">    java.lang.Object readResolve();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#Fragment不需要在AndroidManifest.xml中注册，需要额外保护下</span><br><span class="line">-keep public class * extends android.support.v4.app.Fragment</span><br><span class="line">-keep public class * extends android.app.Fragment</span><br><span class="line"></span><br><span class="line"># 保持测试相关的代码</span><br><span class="line">-dontnote junit.framework.**</span><br><span class="line">-dontnote junit.runner.**</span><br><span class="line">-dontwarn android.test.**</span><br><span class="line">-dontwarn android.support.test.**</span><br><span class="line">-dontwarn org.junit.**</span><br></pre></td></tr></table></figure>

<p>补充的混淆规则：</p>
<ol>
<li><p>第三方库混淆规则。这个比较常见，直接接入官方说明文档。</p>
</li>
<li><p>model实体类，典型在转化json的时候，必须保证model不被混淆，因此需加入–keep public class</p>
</li>
<li><p>JNI中调用的类以及方法不可被混淆</p>
</li>
<li><p>WebView中JavaScript调用的接口不混淆</p>
</li>
<li><p>AndroidMainfest、四大组件以及Application的子类不混淆</p>
</li>
<li><p>Parcelable的子类和Creator静态成员变量不混淆，否则会产生Android.os.BadParcelableException异常</p>
</li>
<li><p>Layout布局使用的View构造函数、android:onClick等。</p>
</li>
</ol>
<h1 id="apk打包流程"><a href="#apk打包流程" class="headerlink" title="apk打包流程"></a>apk打包流程</h1><p><img src="https://upload-images.jianshu.io/upload_images/1441907-8a2c24bbb71c2cbf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/536" alt="打包流程"></p>
<ol>
<li>aapt打包res资源文件，生成R文件。</li>
<li>处理aidl,生成java文件</li>
<li>编译java 生成class文件</li>
<li>通过dex命令，将class文件生成dex文件</li>
<li>apkbuilder阶段，将资源、dex、so合并成apk</li>
<li>对apk进行签名</li>
<li>zipalign阶段,将签名后的apk进行对齐</li>
</ol>
<h1 id="参考连接"><a href="#参考连接" class="headerlink" title="参考连接"></a>参考连接</h1><ul>
<li><p><a href="https://www.gitbook.com/book/chaosleong/gradle-for-android" target="_blank" rel="noopener">Gradle Android Plugin 中文手册</a></p>
</li>
<li><p><a href="https://dongchuan.gitbooks.io/gradle-user-guide-/" target="_blank" rel="noopener">Gradle User Guide 中文版</a></p>
</li>
<li><p><a href="https://developer.android.com/studio/releases/gradle-plugin.html" target="_blank" rel="noopener">Android Plugin for Gradle Release Notes</a></p>
</li>
<li><p><a href="https://www.jianshu.com/p/7c288a17cda8" target="_blank" rel="noopener">Android 打包过程</a></p>
</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">reoger</p>
  <div class="site-description" itemprop="description">reoger</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">56</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">11</span>
        <span class="site-state-item-name">分类</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">标签</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">reoger</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
